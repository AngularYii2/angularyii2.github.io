{"version":3,"sources":["modules/collapse.js"],"names":["angular","module","provider","controller","this","animation","self","forEach","startCollapsed","isDefined","allowMultiple","$scope","$element","$attrs","activeIndexes","$targets","$active","i","length","index","value","indexOf","activeItems","splice","activateItem","$options","$get","defaults","$collapse","copy","$toggles","push","element","key","falseValueRegExp","test","$unregisterToggle","$registerToggle","$unregisterTarget","deactivateItem","$viewChangeListeners","fn","fixActiveItemIndexes","$setActive","disallowToggle","isActive","$activeIndexes","link","require","directive","bsCollapseCtrl","controllers","$window","$animate","ngModelCtrl","$setViewValue","$formatters","attrs","modelValue","isArray","scope","bsCollapseToggle","$apply","$on","on","$registerTarget","render","active","action","activeClass","addClass"],"mappings":"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","file":"modules/collapse.min.js","sourcesContent":["'use strict';\n\nangular.module('mgcrea.ngStrap.collapse', [])\n\n  .provider('$collapse', function() {\n\n    var defaults = this.defaults = {\n      animation: 'am-collapse',\n      disallowToggle: false,\n      activeClass: 'in',\n      startCollapsed: false,\n      allowMultiple: false\n    };\n\n    var controller = this.controller = function($scope, $element, $attrs) {\n      var self = this;\n\n      // Attributes options\n      self.$options = angular.copy(defaults);\n      angular.forEach(['animation', 'disallowToggle', 'activeClass', 'startCollapsed', 'allowMultiple'], function (key) {\n        if(angular.isDefined($attrs[key])) self.$options[key] = $attrs[key];\n      });\n\n      // use string regex match boolean attr falsy values, leave truthy values be\n      var falseValueRegExp = /^(false|0|)$/i;\n      angular.forEach(['disallowToggle', 'startCollapsed', 'allowMultiple'], function(key) {\n        if(angular.isDefined($attrs[key]) && falseValueRegExp.test($attrs[key]))\n          self.$options[key] = false;\n      });\n\n      self.$toggles = [];\n      self.$targets = [];\n\n      self.$viewChangeListeners = [];\n\n      self.$registerToggle = function(element) {\n        self.$toggles.push(element);\n      };\n      self.$registerTarget = function(element) {\n        self.$targets.push(element);\n      };\n\n      self.$unregisterToggle = function(element) {\n        var index = self.$toggles.indexOf(element);\n        // remove toggle from $toggles array\n        self.$toggles.splice(index, 1);\n      };\n      self.$unregisterTarget = function(element) {\n        var index = self.$targets.indexOf(element);\n\n        // remove element from $targets array\n        self.$targets.splice(index, 1);\n\n        if (self.$options.allowMultiple) {\n          // remove target index from $active array values\n          deactivateItem(element);\n        }\n\n        // fix active item indexes\n        fixActiveItemIndexes(index);\n\n        self.$viewChangeListeners.forEach(function(fn) {\n          fn();\n        });\n      };\n\n      // use array to store all the currently open panels\n      self.$targets.$active = !self.$options.startCollapsed ? [0] : [];\n      self.$setActive = $scope.$setActive = function(value) {\n        if(angular.isArray(value)) {\n          self.$targets.$active = value;\n        }\n        else if(!self.$options.disallowToggle) {\n          // toogle element active status\n          isActive(value) ? deactivateItem(value) : activateItem(value);\n        } else {\n          activateItem(value);\n        }\n\n        self.$viewChangeListeners.forEach(function(fn) {\n          fn();\n        });\n      };\n\n      self.$activeIndexes = function() {\n        return self.$options.allowMultiple ? self.$targets.$active :\n          self.$targets.$active.length === 1 ? self.$targets.$active[0] : -1;\n      };\n\n      function fixActiveItemIndexes(index) {\n        // item with index was removed, so we\n        // need to adjust other items index values\n        var activeIndexes = self.$targets.$active;\n        for(var i = 0; i < activeIndexes.length; i++) {\n          if (index < activeIndexes[i]) {\n            activeIndexes[i] = activeIndexes[i] - 1;\n          }\n\n          // the last item is active, so we need to\n          // adjust its index\n          if (activeIndexes[i] === self.$targets.length) {\n            activeIndexes[i] = self.$targets.length - 1;\n          }\n        }\n      }\n\n      function isActive(value) {\n        var activeItems = self.$targets.$active;\n        return activeItems.indexOf(value) === -1 ? false : true;\n      }\n\n      function deactivateItem(value) {\n        var index = self.$targets.$active.indexOf(value);\n        if (index !== -1) {\n          self.$targets.$active.splice(index, 1);\n        }\n      }\n\n      function activateItem(value) {\n        if (!self.$options.allowMultiple) {\n          // remove current selected item\n          self.$targets.$active.splice(0, 1);\n        }\n\n        if (self.$targets.$active.indexOf(value) === -1) {\n          self.$targets.$active.push(value);\n        }\n      }\n\n    };\n\n    this.$get = function() {\n      var $collapse = {};\n      $collapse.defaults = defaults;\n      $collapse.controller = controller;\n      return $collapse;\n    };\n\n  })\n\n  .directive('bsCollapse', function($window, $animate, $collapse) {\n\n    var defaults = $collapse.defaults;\n\n    return {\n      require: ['?ngModel', 'bsCollapse'],\n      controller: ['$scope', '$element', '$attrs', $collapse.controller],\n      link: function postLink(scope, element, attrs, controllers) {\n\n        var ngModelCtrl = controllers[0];\n        var bsCollapseCtrl = controllers[1];\n\n        if(ngModelCtrl) {\n\n          // Update the modelValue following\n          bsCollapseCtrl.$viewChangeListeners.push(function() {\n            ngModelCtrl.$setViewValue(bsCollapseCtrl.$activeIndexes());\n          });\n\n          // modelValue -> $formatters -> viewValue\n          ngModelCtrl.$formatters.push(function(modelValue) {\n            // console.warn('$formatter(\"%s\"): modelValue=%o (%o)', element.attr('ng-model'), modelValue, typeof modelValue);\n            if (angular.isArray(modelValue)) {\n              // model value is an array, so just replace\n              // the active items directly\n              bsCollapseCtrl.$setActive(modelValue);\n            }\n            else {\n              var activeIndexes = bsCollapseCtrl.$activeIndexes();\n\n              if (angular.isArray(activeIndexes)) {\n                // we have an array of selected indexes\n                if (activeIndexes.indexOf(modelValue * 1) === -1) {\n                  // item with modelValue index is not active\n                  bsCollapseCtrl.$setActive(modelValue * 1);\n                }\n              }\n              else if (activeIndexes !== modelValue * 1) {\n                bsCollapseCtrl.$setActive(modelValue * 1);\n              }\n            }\n            return modelValue;\n          });\n\n        }\n\n      }\n    };\n\n  })\n\n  .directive('bsCollapseToggle', function() {\n\n    return {\n      require: ['^?ngModel', '^bsCollapse'],\n      link: function postLink(scope, element, attrs, controllers) {\n\n        var ngModelCtrl = controllers[0];\n        var bsCollapseCtrl = controllers[1];\n\n        // Add base attr\n        element.attr('data-toggle', 'collapse');\n\n        // Push pane to parent bsCollapse controller\n        bsCollapseCtrl.$registerToggle(element);\n\n        // remove toggle from collapse controller when toggle is destroyed\n        scope.$on('$destroy', function() {\n          bsCollapseCtrl.$unregisterToggle(element);\n        });\n\n        element.on('click', function() {\n          var index = attrs.bsCollapseToggle || bsCollapseCtrl.$toggles.indexOf(element);\n          bsCollapseCtrl.$setActive(index * 1);\n          scope.$apply();\n        });\n\n      }\n    };\n\n  })\n\n  .directive('bsCollapseTarget', function($animate) {\n\n    return {\n      require: ['^?ngModel', '^bsCollapse'],\n      // scope: true,\n      link: function postLink(scope, element, attrs, controllers) {\n\n        var ngModelCtrl = controllers[0];\n        var bsCollapseCtrl = controllers[1];\n\n        // Add base class\n        element.addClass('collapse');\n\n        // Add animation class\n        if(bsCollapseCtrl.$options.animation) {\n          element.addClass(bsCollapseCtrl.$options.animation);\n        }\n\n        // Push pane to parent bsCollapse controller\n        bsCollapseCtrl.$registerTarget(element);\n\n        // remove pane target from collapse controller when target is destroyed\n        scope.$on('$destroy', function() {\n          bsCollapseCtrl.$unregisterTarget(element);\n        });\n\n        function render() {\n          var index = bsCollapseCtrl.$targets.indexOf(element);\n          var active = bsCollapseCtrl.$activeIndexes();\n          var action = 'removeClass';\n          if (angular.isArray(active)) {\n            if (active.indexOf(index) !== -1) {\n              action = 'addClass';\n            }\n          }\n          else if (index === active) {\n            action = 'addClass';\n          }\n\n          $animate[action](element, bsCollapseCtrl.$options.activeClass);\n        }\n\n        bsCollapseCtrl.$viewChangeListeners.push(function() {\n          render();\n        });\n        render();\n\n      }\n    };\n\n  });\n"],"sourceRoot":"/source/"}